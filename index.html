<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MetabolicRx NutritionAI | Personalized Meal Planning</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Previous CSS styles remain the same */
        
        /* Update meal header styles */
        .meal-header {
            display: flex;
            flex-direction: column;
            margin-bottom: 0.5rem;
        }
        
        .meal-type {
            font-weight: 600;
            color: var(--primary);
            text-transform: capitalize;
            margin-bottom: 0.25rem;
        }
        
        .meal-time {
            color: var(--gray-700);
            font-size: 0.875rem;
        }
        
        /* Keep all other existing styles the same */
    </style>
</head>
<body>
    <!-- Previous HTML remains the same until the JavaScript -->
    
    <script>
        // Previous JavaScript remains the same until the displaySampleMealPlan function
        
        function displaySampleMealPlan(formData, apiActive) {
            // This is just sample data for demonstration
            // In a real app, you would use the actual API response
            
            let mealPlanHTML = '';
            
            const days = parseInt(formData.days);
            const hasBreakfast = formData.meals.breakfast;
            const hasLunch = formData.meals.lunch;
            const hasDinner = formData.meals.dinner;
            const hasSnacks = formData.meals.snacks;
            const allergies = formData.allergies;
            const medication = formData.medication;
            
            if (apiActive) {
                mealPlanHTML += '<div style="margin-bottom: 1rem; color: var(--secondary); font-size: 0.875rem;"><i class="fas fa-check-circle"></i> Powered by Google AI</div>';
            }
            
            // Define meal templates with times
            const mealTemplates = [
                {
                    type: 'breakfast',
                    name: 'Avocado and Spinach Omelet with Whole Grain Toast',
                    time: '8:00 AM',
                    description: 'Fluffy omelet packed with healthy fats and fiber',
                    calories: '450',
                    protein: '22g',
                    carbs: '35g',
                    show: hasBreakfast
                },
                {
                    type: 'lunch',
                    name: 'Grilled Chicken Salad with Balsamic Vinaigrette',
                    time: '12:30 PM',
                    description: 'Protein-rich salad with mixed greens and light dressing',
                    calories: '550',
                    protein: '40g',
                    carbs: '20g',
                    show: hasLunch
                },
                {
                    type: 'snack',
                    name: 'Greek Yogurt with Mixed Berries and Almonds',
                    time: '3:00 PM',
                    description: 'Protein-packed snack with antioxidants',
                    calories: '250',
                    protein: '15g',
                    carbs: '20g',
                    show: hasSnacks
                },
                {
                    type: 'dinner',
                    name: 'Baked Salmon with Quinoa and Roasted Asparagus',
                    time: '6:30 PM',
                    description: 'Heart-healthy omega-3s with complex carbs',
                    calories: '600',
                    protein: '45g',
                    carbs: '40g',
                    show: hasDinner
                }
            ];
            
            for (let i = 1; i <= days; i++) {
                const dayName = new Date(Date.now() + (i * 24 * 60 * 60 * 1000)).toLocaleDateString('en-US', { weekday: 'long' });
                
                mealPlanHTML += `
                    <div class="day">
                        <div class="day-header">Day ${i}: ${dayName}</div>
                `;
                
                // Filter and sort meals by time
                const mealsToShow = mealTemplates
                    .filter(meal => meal.show)
                    .sort((a, b) => {
                        // Convert times to 24-hour format for sorting
                        const timeA = convertTo24Hour(a.time);
                        const timeB = convertTo24Hour(b.time);
                        return timeA - timeB;
                    });
                
                // Add meals in chronological order
                mealsToShow.forEach(meal => {
                    mealPlanHTML += `
                        <div class="meal" onclick="showRecipeDetail('${meal.name}', ${i}, '${meal.type}', '${allergies}', '${medication}')">
                            <div class="meal-header">
                                <div class="meal-type">${meal.type}</div>
                                <div class="meal-time">${meal.time}</div>
                            </div>
                            <div class="meal-name">${meal.name}</div>
                            <div class="meal-description">
                                ${meal.description}${allergies ? ' (Allergy-aware)' : ''}${medication !== 'none' ? ' (Medication-adjusted)' : ''}
                            </div>
                            <div class="meal-nutrition">
                                <div class="nutrition-item"><span>Calories:</span> <span>${meal.calories}</span></div>
                                <div class="nutrition-item"><span>Protein:</span> <span>${meal.protein}</span></div>
                                <div class="nutrition-item"><span>Carbs:</span> <span>${meal.carbs}</span></div>
                            </div>
                        </div>
                    `;
                });
                
                mealPlanHTML += `</div>`;
            }
            
            mealPlanElement.innerHTML = mealPlanHTML;
            mealPlanElement.style.display = 'block';
        }
        
        function convertTo24Hour(timeStr) {
            // Helper function to convert "8:00 AM" to 800, "1:30 PM" to 1330, etc.
            const [time, modifier] = timeStr.split(' ');
            let [hours, minutes] = time.split(':');
            
            if (modifier === 'PM' && hours !== '12') {
                hours = parseInt(hours, 10) + 12;
            }
            if (modifier === 'AM' && hours === '12') {
                hours = '00';
            }
            
            return parseInt(hours + minutes, 10);
        }
        
        // Keep all other JavaScript functions the same
    </script>
</body>
</html>